<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Visual Inference for different Lineup Scenarios under a Dirichlet Model — dVis • vinference</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Visual Inference for different Lineup Scenarios under a Dirichlet Model — dVis" />
<meta property="og:description" content="Density, distribution function and quantiles for visual inference scenarios.
Visual inference is used to determine significance of a visual finding. 
The lineup protocol (Buja et al., 2009) establishes a formal framework for 
testing graphical findings. The package nullabor helps with the creation 
of lineups using various null generation models.
Here, we provide functions to evaluate results." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vinference</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/heike/vinference/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visual Inference for different Lineup Scenarios under a Dirichlet Model</h1>
    <small class="dont-index">Source: <a href='http://github.com/heike/vinference/blob/master/R/pvalues.r'><code>R/pvalues.r</code></a></small>
    <div class="hidden name"><code>dVis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Density, distribution function and quantiles for visual inference scenarios.
Visual inference is used to determine significance of a visual finding. 
The lineup protocol (Buja et al., 2009) establishes a formal framework for 
testing graphical findings. The package <code>nullabor</code> helps with the creation 
of lineups using various null generation models.
Here, we provide functions to evaluate results.</p>
    </div>

    <pre class="usage"><span class='fu'>dVis</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>K</span>, m <span class='op'>=</span> <span class='fl'>20</span>, <span class='va'>alpha</span>, scenario <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='fu'>pVis</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>K</span>, m <span class='op'>=</span> <span class='fl'>20</span>, <span class='va'>alpha</span>, scenario <span class='op'>=</span> <span class='fl'>3</span>, lower.tail <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>qVis</span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>K</span>, m <span class='op'>=</span> <span class='fl'>20</span>, <span class='va'>alpha</span>, scenario <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>vector, number of data identifications,</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>positive value, number of evaluations of the lineup,</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>number of panels in the lineup,</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>positive value, rate parameter of the flat Dirichlet distribution,</p></td>
    </tr>
    <tr>
      <th>scenario</th>
      <td><p>integer value.</p></td>
    </tr>
    <tr>
      <th>lower.tail</th>
      <td><p>defaults to TRUE, if TRUE probabilities are \(P(X \leq x)\), otherwise, \(P(X \geq x)\). 
Note that the second probability is a deviation from R standard: usually \(P(X &gt; x)\) is returned. 
However, here, returning \(P(X \geq x)\) is more useful in an inference setting, as it corresponds to the 
p value.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>(vector of) probabilities,</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The functions return (a vector of) quantiles or probabilities for \(P(X = x)\), \(P(X \leq x)\).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When administering visual tests, we distinguish between three different scenarios:</p><ul>
<li><p>Scenario 1: in each of K evaluations a different data set and a different set of (m-1) null plots is shown.</p></li>
<li><p>Scenario 2: in each of K evaluations the same data set but a different set of (m-1) null plots is shown.</p></li>
<li><p>Scenario 3: the same lineup, i.e. same data and same set of null plots, is shown to K different observers.</p></li>
</ul><p>Under scenario 3, the number of data picks under the null hypothesis that the data plot is 
visually not more salient than one of the null plots is distributed according 
to a ratio of Beta functions:
$$P (X = x) = {K \choose x} \frac{B(x + \alpha, K-x+(m-1)\alpha)}{B(\alpha, (m-1)\alpha)}$$
where 
\(B(.,.)\) is the Beta function, 
\(\alpha &gt; 0\) is the rate of a flat Dirichlet distribution,
\(K\) is the number of times the lineup has been evaluated, 
\(x\) number of times the data plot has been picked as the visually most interesting,
\(m\) is the number of panels in a lineup (the lineup size).</p>
<p>For large values of alpha, scenario 3 converges to scenario 1.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Andreas Buja, Dianne Cook, Heike Hofmann, Michael Lawrence, Eun-Kyung Lee, Deborah F. Swayne and Hadley Wickham, Statistical inference for exploratory data analysis and model diagnostics.
Phil. Trans. R. Soc. A. 367: 4361-4383, 2009, <a href='https://doi.org/10.1098/rsta.2009.0120'>https://doi.org/10.1098/rsta.2009.0120</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Probabilities to see between 5 and 10 data identifications</span>
<span class='co'># in lineup of size 20, with 15 evaluations, and an estimated </span>
<span class='co'># alpha of 0.1</span>
<span class='fu'>dVis</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>5</span><span class='op'>:</span><span class='fl'>10</span>, K<span class='op'>=</span> <span class='fl'>15</span>, m<span class='op'>=</span><span class='fl'>20</span>, alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.013705202 0.010687543 0.008466755 0.006754377 0.005386402 0.004262284</div><div class='input'>
<span class='va'>dframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  x<span class='op'>=</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>15</span>, 
  probabilities <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>dVis</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>15</span>, K<span class='op'>=</span><span class='fl'>15</span>, alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
                    <span class='fu'>dVis</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>15</span>, K<span class='op'>=</span><span class='fl'>15</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                    <span class='fu'>dVis</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>15</span>, K<span class='op'>=</span><span class='fl'>15</span>, alpha <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
  alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>1</span>, <span class='fl'>5</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span><span class='op'>)</span>                  
<span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>dframe</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>probabilities</span>, colour <span class='op'>=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> 
</div><div class='img'><img src='dVis-1.png' alt='' width='700' height='433' /></div><div class='input'>  
 <span class='co'># how many data picks do we need in a lineup of size m</span>
 <span class='co'># with K = 30 evaluations and alpha = 0.1 to achieve a </span>
 <span class='co'># significance at 10%, 5% or 1%?</span>
 <span class='fu'>qVis</span><span class='op'>(</span>p <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span><span class='op'>)</span>, K <span class='op'>=</span> <span class='fl'>30</span>, m<span class='op'>=</span><span class='fl'>20</span>, alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  5 10 20</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Heike Hofmann, Susan Vanderplas, Christian Röttger, Di Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


